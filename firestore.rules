// TODO: Enable production rules after RevenueCat webhook is implemented
// Currently using test mode rules in Firebase Console
//
// rules_version = '2';
//
// service cloud.firestore {
//   match /databases/{database}/documents {
//
//     match /users/{uid} {
//       // Users can read their own document
//       allow read: if request.auth != null && request.auth.uid == uid;
//
//       // Users can write their own document, but NOT protected fields
//       allow write: if request.auth != null
//                    && request.auth.uid == uid
//                    && !request.resource.data.diff(resource.data).affectedKeys()
//                        .hasAny(['subscriptionTier', 'isPremium', 'dailyMessageCount']);
//
//       // Allow create for new users (first sign-in), without protected fields
//       allow create: if request.auth != null
//                     && request.auth.uid == uid
//                     && !request.resource.data.keys()
//                         .hasAny(['subscriptionTier', 'isPremium', 'dailyMessageCount']);
//     }
//
//     // Deny everything else
//     match /{document=**} {
//       allow read, write: if false;
//     }
//   }
// }
